{"version":3,"sources":["ucsf_multirange-slider.js"],"names":["$","$dropdownPanel","$selectMin","$selectMax","minRange","parseInt","find","text","maxRange","currentMinValue","currentMaxValue","desktopDetect","event","$publicationRange","matches","slider","range","min","max","step","values","animate","slide","ui","stop","$selectMinOptionVal","val","$selectMaxOptionVal","undefined","$handleMin","first","attr","yearLabelMin","append","$handleMax","last","yearLabelMax","trackLabel","updateSlider","selectMinOption","selectMaxOption","isNaN","one","click","hasClass","empty","mql","matchMedia","addListener","jQuery"],"mappings":"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","file":"ucsf_multirange-slider.js","sourcesContent":["(($ => {\n  // Wait for the document to be ready.\n  $(() => {\n    const $dropdownPanel = $('.search-filter__dropdown');\n\n    const $selectMin = $('#edit-field-date-and-time-value-1');\n    const $selectMax = $('#edit-field-date-and-time-value-2');\n\n    // Min and Max year range.\n    const minRange = parseInt($selectMin.find('option:nth-child(2)').text());\n    const maxRange = parseInt($selectMax.find('option:nth-child(2)').text());\n\n    // Default values for min and max publication year handles\n    let currentMinValue = minRange;\n    let currentMaxValue = maxRange;\n\n    if (currentMinValue >= currentMaxValue) {\n      currentMinValue -= 1;\n    }\n\n    // Only execute subnav extend / collapse code in mobile\n    const desktopDetect = (event) => {\n      const $publicationRange = $('.publication-range');\n\n      // Desktop\n      if (event.matches) {\n        // JQUERY SLIDER UI OBJECT https://api.jqueryui.com/slider/#event-slide\n        $publicationRange.slider({\n          range: true,\n          min: minRange,\n          max: maxRange,\n          step: 1,\n          values: [currentMinValue, currentMaxValue],\n          animate: \"fast\",\n\n          // Triggered on every mouse move during slide\n          slide: function(event, ui) {\n            currentMinValue = ui.values[0];\n            currentMaxValue = ui.values[1];\n\n            if (currentMinValue >= currentMaxValue) {\n              return false;\n            }\n\n            // Update floating labels for handles\n            $('.min-limit').text(currentMinValue);\n            $('.max-limit').text(currentMaxValue);\n          },\n\n          stop: function(event, ui) {\n            currentMinValue = ui.values[0];\n            currentMaxValue = ui.values[1];\n\n            // Find out what the select value of a chosen date is.\n            let $selectMinOptionVal = $selectMin.find(`option:contains(${currentMinValue})`).val();\n            let $selectMaxOptionVal = $selectMax.find(`option:contains(${currentMaxValue})`).val();\n\n            // Sanitize.\n            if ($selectMinOptionVal === undefined) {\n              $selectMinOptionVal = 'All'\n            }\n            if ($selectMaxOptionVal === undefined) {\n              $selectMaxOptionVal = 'All'\n            }\n\n            // Set the selected option.\n            $selectMin.val($selectMinOptionVal);\n            $selectMax.val($selectMaxOptionVal);\n          },\n        });\n\n        // Minimum Publication Year handle\n        const $handleMin = $('.ui-slider-handle').first();\n        $handleMin.attr({\n          'data-testid':'puplication-year-min',\n        });\n\n        // Create floating labe for Minimum Publication Year handle\n        const yearLabelMin =\n          `<span class='visually-hidden'>Minimum year of publication:</span>\n          <span class='ui-slider__handle-label min-limit'></span>`;\n        $handleMin.append(yearLabelMin);\n\n\n        // Maximum Publication Year handle\n        const $handleMax = $('.ui-slider-handle').last();\n        $handleMax.attr({\n          'data-testid':'puplication-year-max',\n        });\n\n        // Create floating label for Maximum Publication Year handle\n        const yearLabelMax =\n          `<span class='visually-hidden'>Maximum year of publication:</span>\n          <span class='ui-slider__handle-label max-limit'></span>`;\n        $handleMax.append(yearLabelMax);\n\n        // TRACK FOR RANGE SLIDER\n        // Label for the range track\n        const trackLabel =\n          `<p class='ui-slider__track-label'>\n            <span class='visually-hidden'>Available publication years range from</span>\n            <span>${minRange}</span>\n            <span class='visually-hidden'>to</span>\n            <span>${maxRange}</span>\n          </p>`;\n        $('.publication-range').append(trackLabel);\n\n\n        // MAKING SLIDER HANDLES STAY AT THE POSITION OF PREVIOUSLY SUBMITTED QUERY WHEN PANEL IS REOPENED\n        // Sync multirange slider with filter data from dropdowns.\n        const updateSlider = () => {\n          // Find what dropdown values are selected\n          let selectMinOption = parseInt($selectMin.find(':selected').text());\n          let selectMaxOption = parseInt($selectMax.find(':selected').text());\n\n          // Sanitize.\n          if (isNaN(selectMinOption)) {\n            selectMinOption = minRange;\n          };\n          if (isNaN(selectMaxOption)) {\n            selectMaxOption = maxRange;\n          };\n\n          if (selectMinOption >= selectMaxOption) {\n            selectMinOption -= 1;\n          }\n\n          // Provide selected values to the multirange slider\n          $publicationRange.slider('values', 0, selectMinOption);\n          $publicationRange.slider('values', 1, selectMaxOption);\n\n          // Update floating labels for multirange slider handles\n          $('.min-limit').text(selectMinOption);\n          $('.max-limit').text(selectMaxOption);\n        };\n\n        // Check if Advanced Filter Panel is open.\n        $('.search-filter__advanced').one().click(function() {\n          if ($dropdownPanel.hasClass('js-search_filter__dropdown-open')) {\n            updateSlider();\n          }\n        });\n        updateSlider()\n      } else {\n        $publicationRange.slider('destroy').empty();\n      }\n    }\n\n    // Use MatchMedia to ensure that subnav expand/collapse is only happening in mobile\n    const mql = matchMedia('(min-width: 1027px)');\n    // Detect Desktop on page load.\n    desktopDetect(mql);\n    // Watch to see if the page size changes.\n    mql.addListener(desktopDetect);\n  });\n}))(jQuery);\n"]}