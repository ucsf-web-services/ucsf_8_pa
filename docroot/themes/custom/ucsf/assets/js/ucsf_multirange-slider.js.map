{"version":3,"sources":["ucsf_multirange-slider.js"],"names":["$","$dropdownPanel","$selectMin","$selectMax","minRange","parseInt","find","text","maxRange","currentMinValue","currentMaxValue","desktopDetect","event","matches","$publicationRange","slider","range","min","max","step","values","slide","ui","stop","$selectMinOptionVal","val","$selectMaxOptionVal","undefined","handleMin","first","attr","yearLabelMin","append","handleMax","last","yearLabelMax","trackLabel","updateSlider","$selectMinOption","$selectMaxOption","isNaN","one","click","hasClass","mql","matchMedia","addListener","jQuery"],"mappings":"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","file":"ucsf_multirange-slider.js","sourcesContent":["(($ => {\n  // Wait for the document to be ready.\n  $(() => {\n    const $dropdownPanel = $('.search-filter__dropdown');\n\n    const $selectMin = $('#edit-field-date-and-time-value-1');\n    const $selectMax = $('#edit-field-date-and-time-value-2');\n\n    // Min and Max year range.\n    const minRange = parseInt($selectMin.find('option:nth-child(2)').text());\n    const maxRange = parseInt($selectMax.find('option:nth-child(2)').text());\n\n    // Default values for min and max publication year handles\n    let currentMinValue = minRange;\n    let currentMaxValue = maxRange;\n    // Only execute subnav extend / collapse code in mobile\n    const desktopDetect = (event) => {\n      // Desktop\n      if (event.matches) {\n        // JQUERY SLIDER UI OBJECT https://api.jqueryui.com/slider/#event-slide\n        const $publicationRange = $('.publication-range');\n        $publicationRange.slider({\n          range: true,\n          min: minRange,\n          max: maxRange,\n          step: 1,\n          values: [currentMinValue, currentMaxValue],\n\n          // Triggered on every mouse move during slide\n          slide: function(event, ui) {\n            currentMinValue = ui.values[0];\n            currentMaxValue = ui.values[1];\n\n            // Update floating labels for handles\n            $('.min-limit').text(currentMinValue);\n            $('.max-limit').text(currentMaxValue);\n          },\n\n          stop: function(event, ui) {\n            currentMinValue = ui.values[0];\n            currentMaxValue = ui.values[1];\n\n            // Find out what the select value of a chosen date is.\n            let $selectMinOptionVal = $selectMin.find(`option:contains(${currentMinValue})`).val();\n            let $selectMaxOptionVal = $selectMax.find(`option:contains(${currentMaxValue})`).val();\n\n            // Sanitize.\n            if ($selectMinOptionVal === undefined) {\n              $selectMinOptionVal = 'All'\n            }\n            if ($selectMaxOptionVal === undefined) {\n              $selectMaxOptionVal = 'All'\n            }\n\n            // Set the selected option.\n            $selectMin.val($selectMinOptionVal);\n            $selectMax.val($selectMaxOptionVal);\n          }\n        });\n\n        // Minimum Publication Year handle\n        const handleMin = $('.ui-slider-handle').first();\n        handleMin.attr({\n          'data-testid':'puplication-year-min',\n        });\n\n        // Create floating labe for Minimum Publication Year handle\n        const yearLabelMin =\n          `<span class='visually-hidden'>Minimum year of publication:</span>\n          <span class='ui-slider__handle-label min-limit'></span>`;\n        handleMin.append(yearLabelMin);\n\n\n        // Maximum Publication Year handle\n        const handleMax = $('.ui-slider-handle').last();\n        handleMax.attr({\n          'data-testid':'puplication-year-max',\n        });\n\n        // Create floating label for Maximum Publication Year handle\n        const yearLabelMax =\n          `<span class='visually-hidden'>Maximum year of publication:</span>\n          <span class='ui-slider__handle-label max-limit'></span>`;\n        handleMax.append(yearLabelMax);\n\n        // TRACK FOR RANGE SLIDER\n        // Label for the range track\n        const trackLabel =\n          `<p class='ui-slider__track-label'>\n            <span class='visually-hidden'>Available publication years range from</span>\n            <span>${minRange}</span>\n            <span class='visually-hidden'>to</span>\n            <span>${maxRange}</span>\n          </p>`;\n        $('.publication-range').append(trackLabel);\n\n\n        // MAKING SLIDER HANDLES STAY AT THE POSITION OF PREVIOUSLY SUBMITTED QUERY WHEN PANEL IS REOPENED\n        // Sync multirange slider with filter data from dropdowns.\n        const updateSlider = () => {\n          // Find what dropdown values are selected\n          let $selectMinOption = parseInt($selectMin.find(':selected').text());\n          let $selectMaxOption = parseInt($selectMax.find(':selected').text());\n\n          // Sanitize.\n          if (isNaN($selectMinOption)) {\n            $selectMinOption = minRange;\n          };\n          if (isNaN($selectMaxOption)) {\n            $selectMaxOption = maxRange;\n          };\n\n          // Provide selected values to the multirange slider\n          $publicationRange.slider('values', 0, $selectMinOption);\n          $publicationRange.slider('values', 1, $selectMaxOption);\n\n          // Update floating labels for multirange slider handles\n          $('.min-limit').text($selectMinOption);\n          $('.max-limit').text($selectMaxOption);\n        };\n\n        // Check if Advanced Filter Panel is open.\n        $('.search-filter__advanced').one().click(function() {\n          if ($dropdownPanel.hasClass('js-search_filter__dropdown-open')) {\n            updateSlider();\n          }\n        });\n      }\n    }\n\n    // Use MatchMedia to ensure that subnav expand/collapse is only happening in mobile\n    const mql = matchMedia('(min-width: 1027px)');\n    // Detect Desktop on page load.\n    desktopDetect(mql);\n    // Watch to see if the page size changes.\n    mql.addListener(desktopDetect);\n  });\n}))(jQuery);\n"]}