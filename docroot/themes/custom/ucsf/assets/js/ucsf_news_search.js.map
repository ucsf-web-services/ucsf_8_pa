{"version":3,"sources":["ucsf_news_search.js"],"names":["$","Drupal","behaviors","search_news","attach","context","click","openAdvancedFilter","siblings","toggleClass","dateFocus","removeClass","setTimeout","focus","removeFilter","filter_item","filter_id","attr","prop","submit","length","document","ready","$publicationRange","slider","range","min","max","step","values","publicationMin","publicationMax","$handle","handleMin","first","yearLabelMin","append","handleMax","last","yearLabelMax","minLimit","maxLimit","validateMinMax","value","year","Date","getFullYear","newValue","parseInt","change","newYear","val","console","log","trackLabel","waypoint","handler","direction","addClass","offset","jQuery"],"mappings":";;AAAA;AACA,CAAC,UAAUA,CAAV,EAAa;AACZC,SAAOC,SAAP,CAAiBC,WAAjB,GAA+B;AAC7BC,YAAQ,gBAAUC,OAAV,EAAmB;;AAEzB;AACAL,QAAE,0BAAF,EAA8BK,OAA9B,EAAuCC,KAAvC,CAA6C,YAAW;AACtDC;AACD,OAFD;;AAIA;AACAP,QAAE,iCAAF,EAAqCK,OAArC,EAA8CC,KAA9C,CAAoD,YAAW;AAC7DN,UAAE,IAAF,EAAQQ,QAAR,CAAiB,mBAAjB,EAAsCC,WAAtC,CAAkD,iCAAlD;AACD,OAFD;;AAIAT,QAAE,yCAAF,EAA6CK,OAA7C,EAAsDC,KAAtD,CAA4D,YAAW;AACrEN,UAAE,yCAAF,EAA6CK,OAA7C,EAAsDC,KAAtD;AACAN,UAAE,yCAAF,EAA6CK,OAA7C,EAAsDC,KAAtD;AACAN,UAAE,yCAAF,EAA6CK,OAA7C,EAAsDC,KAAtD;AACAN,UAAE,yCAAF,EAA6CK,OAA7C,EAAsDC,KAAtD;AACD,OALD;;AAOA;AACAN,QAAE,+BAAF,EAAmCK,OAAnC,EAA4CC,KAA5C,CAAkD,YAAW;AAC3DC,2BAAmB,IAAnB;AACD,OAFD;;AAIA;AACA,eAASA,kBAAT,CAA4BG,SAA5B,EAAuC;AACrCV,UAAE,0BAAF,EAA8BS,WAA9B,CAA0C,iCAA1C;AACAT,UAAE,qBAAF,EAAyBS,WAAzB,CAAqC,4BAArC;AACAT,UAAE,mBAAF,EAAuBW,WAAvB,CAAmC,iCAAnC;AACAX,UAAE,MAAF,EAAUS,WAAV,CAAsB,2BAAtB;;AAEA,YAAIC,aAAa,IAAjB,EAAuB;AACrBE,qBAAW,YAAW;AAClBZ,cAAE,2DAAF,EAA+Da,KAA/D;AACD,WAFH,EAEK,GAFL;AAGD;AACF;;AAED;AACA,eAASC,YAAT,GAAwB;AACtB,YAAMC,cAAcf,EAAE,gCAAF,CAApB;;AAEAe,oBAAYT,KAAZ,CAAkB,YAAY;AAC5B,cAAMU,YAAYhB,EAAE,IAAF,EAAQiB,IAAR,CAAa,UAAb,CAAlB;;AAEA;AACAjB,YAAE,aAAagB,SAAb,GAAyB,IAA3B,EAAiCE,IAAjC,CAAsC,SAAtC,EAAiD,KAAjD;;AAEA;AACAlB,YAAE,8CAAF,EAAkDmB,MAAlD;AACD,SARD;;AAUA;AACA,YAAIJ,YAAYK,MAAZ,GAAqB,CAAzB,EAA4B;AAC1B;AACApB,YAAE,sCAAF,EAA0CW,WAA1C,CAAsD,iBAAtD;AACD;AACF;;AAED;AACAX,QAAEqB,QAAF,EAAYC,KAAZ,CAAkB,YAAW;AAC3B;AACA;AACA;AACA;;AAEA;AACA,YAAMC,oBAAoBvB,EAAE,oBAAF,EAAwBK,OAAxB,CAA1B;AACAkB,0BAAkBC,MAAlB,CAAyB;AACvBC,iBAAM,IADiB;AAEvBC,eAAK,IAFkB;AAGvBC,eAAK,IAHkB;AAIvBC,gBAAM,CAJiB;AAKvBC,kBAAQ,CAAC,IAAD,EAAO,IAAP;;AAER;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AArBuB,SAAzB;;AAwBA,YAAMC,iBAAiBP,kBAAkBC,MAAlB,CAAyB,QAAzB,EAAmC,KAAnC,CAAvB;AACA,YAAMO,iBAAiBR,kBAAkBC,MAAlB,CAAyB,QAAzB,EAAmC,KAAnC,CAAvB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAMQ,UAAUhC,EAAE,mBAAF,CAAhB;AACA,YAAMiC,YAAYD,QAAQE,KAAR,EAAlB;AACAD,kBAAUhB,IAAV,CAAe;AACb,wBAAc,KADD;AAEb,yBAAc;AAFD,SAAf;;AAKA;AACA,YAAMkB,0LAIuCL,cAJvC,0GAAN;AAMAG,kBAAUG,MAAV,CAAiBD,YAAjB;;AAGA;AACA,YAAME,YAAYL,QAAQM,IAAR,EAAlB;AACAD,kBAAUpB,IAAV,CAAe;AACb,wBAAc,KADD;AAEb,yBAAc;AAFD,SAAf;;AAKA;AACA,YAAMsB,0LAIuCR,cAJvC,0GAAN;AAMAM,kBAAUD,MAAV,CAAiBG,YAAjB;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,YAAMC,WAAWxC,EAAE,YAAF,CAAjB;AACA,YAAMyC,WAAWzC,EAAE,YAAF,CAAjB;;AAEA,YAAM0C,iBAAiB,SAAjBA,cAAiB,CAACC,KAAD,EAAW;AAChC,cAAMC,OAAO,IAAIC,IAAJ,GAAWC,WAAX,EAAb;AACA,cAAIC,WAAWC,SAASL,KAAT,CAAf;;AAEA,cAAII,WAAW,IAAf,EAAqB;AACnBA,uBAAW,IAAX;AACD,WAFD,MAEO,IAAIA,WAAWH,IAAf,EAAqB;AAC1BG,uBAAWH,IAAX;AACD;;AAED,iBAAOG,QAAP;AACD,SAXD;;AAaAP,iBAASS,MAAT,CAAgB,YAAW;AACzB,cAAMC,UAAUR,eAAe1C,EAAE,IAAF,EAAQmD,GAAR,EAAf,CAAhB;AACA5B,4BAAkBC,MAAlB,CAAyB,QAAzB,EAAmC,CAAnC,EAAsC0B,OAAtC;AACAE,kBAAQC,GAAR,CAAYrD,EAAE,IAAF,EAAQmD,GAAR,EAAZ;AACD,SAJD;;AAMAV,iBAASQ,MAAT,CAAgB,YAAW;AACzB,cAAMC,UAAUR,eAAe1C,EAAE,IAAF,EAAQmD,GAAR,EAAf,CAAhB;AACA5B,4BAAkBC,MAAlB,CAAyB,QAAzB,EAAmC,CAAnC,EAAsC0B,OAAtC;AACAE,kBAAQC,GAAR,CAAYrD,EAAE,IAAF,EAAQmD,GAAR,EAAZ;AACD,SAJD;;AAMA;AACA;AACA,YAAMG,iKAGMxB,cAHN,wFAKMC,cALN,4BAAN;AAOA/B,UAAE,oBAAF,EAAwBK,OAAxB,EAAiC+B,MAAjC,CAAwCkB,UAAxC;AACD,OApID;AAqIA;;AAEAxC;AACD;AArM4B,GAA/B;;AAwMAd,IAAE,YAAW;AACT,QAAIuD,WAAWvD,EAAE,aAAF,EAAiBuD,QAAjB,CAA0B;AACrCC,eAAS,iBAAUC,SAAV,EAAqB;;AAEtB,YAAIA,aAAa,MAAjB,EAAyB;AACrBzD,YAAE,qDAAF,EAAyD0D,QAAzD,CAAkE,UAAlE;AACH,SAFD,MAEO;AACH1D,YAAE,qDAAF,EAAyDW,WAAzD,CAAqE,UAArE;AACH;AACR,OARoC;AASrCgD,cAAQ;AAT6B,KAA1B,CAAf;AAWH,GAZD;AAcD,CAvND,EAuNGC,MAvNH","file":"ucsf_news_search.js","sourcesContent":["/* eslint-disable */\n(function ($) {\n  Drupal.behaviors.search_news = {\n    attach: function (context) {\n\n      // Toggle Advanced Filter by Advanced Filter Icon.\n      $(\".search-filter__advanced\", context).click(function() {\n        openAdvancedFilter();\n      });\n\n      // Toggle Subcategory by Label.\n      $(\".search-filter__dropdown legend\", context).click(function() {\n        $(this).siblings(\".fieldset-wrapper\").toggleClass('js-search_filter__category-open');\n      });\n\n      $(\"#edit-field-primary-area-target-id-1006\", context).click(function() {\n        $(\"#edit-field-primary-area-target-id-1016\", context).click();\n        $(\"#edit-field-primary-area-target-id-1011\", context).click();\n        $(\"#edit-field-primary-area-target-id-1021\", context).click();\n        $(\"#edit-field-primary-area-target-id-1026\", context).click();\n      });\n\n      // Toggle Advanced Filter and Focus on Date input by Date Change link.\n      $(\".search-filter__advanced-date\", context).click(function() {\n        openAdvancedFilter(true);\n      });\n\n      // Toggle Advanced Filter Function.\n      function openAdvancedFilter(dateFocus) {\n        $(\".search-filter__dropdown\").toggleClass('js-search_filter__dropdown-open');\n        $(\".search-filter__top\").toggleClass('js-search_filter__top-open');\n        $(\".fieldset-wrapper\").removeClass('js-search_filter__category-open');\n        $(\"body\").toggleClass('js-search_filter__is-open');\n\n        if (dateFocus == true) {\n          setTimeout(function() {\n              $('[data-drupal-selector=\"edit-field-date-and-time-value-1\"]').focus();\n            }, 350);\n        }\n      }\n\n      // Remove filter using filter indicators.\n      function removeFilter() {\n        const filter_item = $('.search-filter__indicator-item');\n\n        filter_item.click(function () {\n          const filter_id = $(this).attr('data-tid');\n\n          // Uncheck term filter.\n          $('[value=\"' + filter_id + '\"]').prop(\"checked\", false);\n\n          // Submit filter.\n          $('[block=\"block-exposedformnews-filterpage-1\"]').submit();\n        })\n\n        // Hide label if there are no active filters.\n        if (filter_item.length > 0) {\n          // console.log(filter_item);\n          $('.search-filter__indicator-list label').removeClass('visually-hidden')\n        }\n      }\n\n      // PUBLICATION YEAR MULTIRANGE SLIDER START\n      $(document).ready(function() {\n        // Default values for min and max publication year handles\n        // TODO: Update next year\n        // let currentMinValue = 2019;\n        // let currentMaxValue = 2020;\n\n        // JQUERY SLIDER UI OBJECT https://api.jqueryui.com/slider/#event-slide\n        const $publicationRange = $('.publication-range', context);\n        $publicationRange.slider({\n          range:true,\n          min: 2000,\n          max: 2020,\n          step: 1,\n          values: [2019, 2020],\n\n          // Triggered on every mouse move during slide\n          // slide: function( event, ui ) {\n          //   $('.min-limit').val( ui.values[0] );\n          //   $('.min-limit').attr({value:ui.values[0]})\n\n          //   $('.max-limit').val( ui.values[1] );\n          //   $('max-limit').attr({value:ui.values[1]})\n          // },\n\n          // // Triggered after the user slides a handle.\n          // stop: function( event, ui ) {\n          //   currentMinValue = ui.values[0];\n          //   currentMaxValue = ui.values[1];\n          //   updateHandleLabel(currentMinValue, currentMaxValue);\n          // },\n        })\n\n        const publicationMin = $publicationRange.slider(\"option\", \"min\");\n        const publicationMax = $publicationRange.slider(\"option\", \"max\");\n\n        // Update values for the floating input\n        // const updateHandleLabel = (minValue, maxValue) => {\n        //   $('.min-limit').attr({\n        //     value: minValue,\n        //     placeholder: minValue,\n        //     max: maxValue,\n        //   });\n\n        //   $('.max-limit').attr({\n        //     value: maxValue,\n        //     placeholder: maxValue,\n        //     min: minValue\n        //   });\n        // }\n\n        // Minimum Publication Year handle\n        const $handle = $('.ui-slider-handle');\n        const handleMin = $handle.first();\n        handleMin.attr({\n          'data-value': 'min',\n          'data-testid':'puplication-year-min',\n        })\n\n        // Create label and input for Minimum Publication Year handle\n        const yearLabelMin =\n          `<label for='min-limit' class='visually-hidden'>\n              Minimum year of publication:\n            </label>\n            <input type='number' value='2019' min='${publicationMin}' id='min-limit' class='ui-slider__handle-label min-limit' maxlength='4' pattern='\\d{4}'/>\n          `;\n        handleMin.append(yearLabelMin);\n\n\n        // Maximum Publication Year handle\n        const handleMax = $handle.last();\n        handleMax.attr({\n          'data-value': 'max',\n          'data-testid':'puplication-year-max',\n        })\n\n        // Create label and input for Maximum Publication Year handle\n        const yearLabelMax =\n          `<label for='max-limit' class='visually-hidden'>\n              Maximum year of publication:\n            </label>\n            <input type='number' value='2020' max='${publicationMax}' id='max-limit' class='ui-slider__handle-label max-limit' maxlength='4' pattern='\\d{4}'/>\n          `;\n        handleMax.append(yearLabelMax);\n\n        // $('.min-limit').one('focus', function() {\n        //   $(this).val('');\n        // });\n\n        // $('.max-limit').one('focus', function() {\n        //   $(this).val('');\n        // });\n\n        // If user typed in a year move handle to that year\n\n        const minLimit = $('.min-limit');\n        const maxLimit = $('.max-limit');\n\n        const validateMinMax = (value) => {\n          const year = new Date().getFullYear();\n          let newValue = parseInt(value);\n\n          if (newValue < 2000) {\n            newValue = 2000;\n          } else if (newValue > year) {\n            newValue = year;\n          }\n\n          return newValue;\n        }\n\n        minLimit.change(function() {\n          const newYear = validateMinMax($(this).val());\n          $publicationRange.slider('values', 0, newYear);\n          console.log($(this).val());\n        });\n\n        maxLimit.change(function() {\n          const newYear = validateMinMax($(this).val());\n          $publicationRange.slider('values', 1, newYear);\n          console.log($(this).val());\n        });\n\n        // TRACK FOR RANGE SLIDER\n        // Label for the range track\n        const trackLabel =\n          `<p class='ui-slider__track-label'>\n            <span class='visually-hidden'>Available publication years range from</span>\n            <span>${publicationMin}</span>\n            <span class='visually-hidden'>to</span>\n            <span>${publicationMax}</span>\n          </p>`\n        $('.publication-range', context).append(trackLabel);\n      });\n      // PUBLICATION YEAR MULTIRANGE SLIDER END\n\n      removeFilter();\n    }\n  };\n\n  $(function() {\n      var waypoint = $('#edit-count').waypoint({\n          handler: function (direction) {\n\n                  if (direction == 'down') {\n                      $('.block-views-exposed-filter-blocknews-filter-page-1').addClass('scrolled');\n                  } else {\n                      $('.block-views-exposed-filter-blocknews-filter-page-1').removeClass('scrolled');\n                  }\n          },\n          offset: '0%'\n      });\n  });\n\n})(jQuery);\n"]}