{"version":3,"sources":["ucsf_social_icons.js"],"names":["$","once","Drupal","behaviors","socialIconsMobile","attach","context","settings","forEach","$socialIcons","$iconPrint","has","lastScroll","hideAndShow","currentScroll","window","pageYOffset","removeClass","addClass","articleDetect","hasSocialNav","document","querySelectorAll","observer","IntersectionObserver","entries","entry","intersectionRatio","addEventListener","removeEventListener","observe","element","mobileDetect","event","matches","css","mql","matchMedia","addListener","jQuery"],"mappings":";;AAAA,CAAC,UAACA,CAAD,EAAIC,IAAJ,EAAa;AACZ;AACAC,SAAOC,SAAP,CAAiBC,iBAAjB,GAAqC;AACnCC,YAAQ,SAASA,MAAT,CAAgBC,OAAhB,EAAyBC,QAAzB,EAAmC;AACzCN,WAAK,qBAAL,EAA4B,MAA5B,EAAoCK,OAApC,EAA6CE,OAA7C,CAAqD,YAAM;AACzD,YAAMC,eAAeT,EAAE,qBAAF,EAAyBM,OAAzB,CAArB;AACA,YAAMI,aAAaV,EAAE,IAAF,EAAQM,OAAR,EAAiBK,GAAjB,CAAqB,mBAArB,CAAnB;AACA,YAAIC,aAAa,CAAjB;;AAEA;AACA,YAAMC,cAAc,SAAdA,WAAc,GAAM;AACxB,cAAMC,gBAAgBC,OAAOC,WAA7B;AACA,cAAIF,gBAAgBF,UAApB,EAAgC;AAC9B;AACAH,yBAAaQ,WAAb,CAAyB,YAAzB;AACD,WAHD,MAGO;AACL;AACAR,yBAAaS,QAAb,CAAsB,YAAtB;AACD;;AAED;AACAN,uBAAaE,aAAb;AACD,SAZD;;AAcA;AACA,YAAOK,gBAAgB,SAAhBA,aAAgB,GAAM;AAC3B,cAAI,0BAA0BJ,MAA9B,EAAsC;AACpC;AACA,gBAAMK,eAAeC,SAASC,gBAAT,CAA0B,0BAA1B,CAArB;;AAEA,gBAAMC,WAAW,IAAIC,oBAAJ,CAAyB,mBAAW;AACnDC,sBAAQjB,OAAR,CAAgB,iBAAS;AACvB;AACA,oBAAIkB,MAAMC,iBAAN,GAA0B,CAA9B,EAAiC;AAC/B;AACAZ,yBAAOa,gBAAP,CAAwB,QAAxB,EAAkCf,WAAlC;AACD,iBAHD,MAGO;AACL;AACA;AACAJ,+BAAaQ,WAAb,CAAyB,YAAzB;AACAF,yBAAOc,mBAAP,CAA2B,QAA3B,EAAqChB,WAArC;AACD;AACF,eAXD;AAYD,aAbgB,CAAjB;;AAeA;AACAO,yBAAaZ,OAAb,CAAqB,mBAAW;AAC9Be,uBAASO,OAAT,CAAiBC,OAAjB;AACD,aAFD;AAGD;AACF,SAzBD;;AA2BA;AACA,YAAMC,eAAe,SAAfA,YAAe,CAACC,KAAD,EAAW;AAC9B;AACA,cAAIA,MAAMC,OAAV,EAAmB;AACjB;AACAxB,uBAAWyB,GAAX,CAAe,SAAf,EAA0B,MAA1B;AACApB,mBAAOa,gBAAP,CAAwB,QAAxB,EAAkCf,WAAlC;AACAM;;AAEA;AACD,WAPD,MAOO;AACLJ,mBAAOc,mBAAP,CAA2B,QAA3B,EAAqChB,WAArC;AACA;AACAH,uBAAWyB,GAAX,CAAe,SAAf,EAA0B,SAA1B;AACA1B,yBAAaQ,WAAb,CAAyB,YAAzB;AACD;AACF,SAfD;;AAiBA;AACA,YAAMmB,MAAMC,WAAW,qBAAX,CAAZ;AACA;AACAL,qBAAaI,GAAb;AACA;AACAA,YAAIE,WAAJ,CAAgBN,YAAhB;AAED,OAzED;AA0ED;AA5EkC,GAArC;AA8ED,CAhFD,EAgFGO,MAhFH,EAgFWtC,IAhFX","file":"ucsf_social_icons.js","sourcesContent":["(($, once) => {\n  // All of this code is used for small screen:\n  Drupal.behaviors.socialIconsMobile = {\n    attach: function attach(context, settings) {\n      once('social-icon-context', 'html', context).forEach(() => {\n        const $socialIcons = $('.article-meta-share', context);\n        const $iconPrint = $('li', context).has('a[title*=\"Print\"]');\n        let lastScroll = 0;\n\n        // Social Navbar behavior\n        const hideAndShow = () => {\n          const currentScroll = window.pageYOffset;\n          if (currentScroll > lastScroll) {\n            // If scrolling down, hide icons\n            $socialIcons.removeClass('is-visible');\n          } else {\n            // If scrolling up, show icons\n            $socialIcons.addClass('is-visible');\n          }\n\n          // Update scroll value\n          lastScroll = currentScroll;\n        };\n\n        // Detect if article is not in viewport.\n        const  articleDetect = () => {\n          if ('IntersectionObserver' in window) {\n            // Article content wrapper\n            const hasSocialNav = document.querySelectorAll('.block-system-main-block');\n\n            const observer = new IntersectionObserver(entries => {\n              entries.forEach(entry => {\n                // Article content is in viewport\n                if (entry.intersectionRatio > 0) {\n                  // show icons on up scroll\n                  window.addEventListener('scroll', hideAndShow);\n                } else {\n                  // Article content is not in viewport\n                  // hide icons and don't trigger the up scroll event.\n                  $socialIcons.removeClass('is-visible');\n                  window.removeEventListener('scroll', hideAndShow);\n                }\n              })\n            })\n\n            // Check if specified element is in viewport\n            hasSocialNav.forEach(element => {\n              observer.observe(element);\n            });\n          }\n        };\n\n        // Only use custom Social Navbar up scroll behavior in mobile\n        const mobileDetect = (event) => {\n          // Mobile\n          if (event.matches) {\n            // Remove \"print\" icon\n            $iconPrint.css('display', 'none');\n            window.addEventListener('scroll', hideAndShow);\n            articleDetect();\n\n            // Desktop\n          } else {\n            window.removeEventListener('scroll', hideAndShow);\n            // Add \"print\" icon\n            $iconPrint.css('display', 'initial');\n            $socialIcons.removeClass('is-visible');\n          }\n        };\n\n        // Use MatchMedia breakpoint to trigger small screen behavior and reset behavior for Desktop.\n        const mql = matchMedia('(max-width: 1049px)');\n        // Detect mobile on page load.\n        mobileDetect(mql);\n        // Watch to see if the page size changes.\n        mql.addListener(mobileDetect);\n\n      });\n    }\n  };\n})(jQuery, once);\n"]}