{"version":3,"sources":["ucsf_sticky_nav.js"],"names":["$","toolbar","document","querySelector","header","minimizedMenuSelected","classList","contains","remove","pathname","window","location","root","documentElement","headerNav","headerBottomY","headerFixedBottomY","headerTop","headerNavY","hasUniversalHeader","setNavHeight","offsetHeight","headerNavHeight","style","setProperty","mql","matchMedia","addListener","mobileToggle","addEventListener","lastScroll","currentScroll","pageYOffset","add","jQuery"],"mappings":"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","file":"ucsf_sticky_nav.js","sourcesContent":["(($ => {\n\n  // Wait for the document to be ready.\n  $(() => {\n\n    const toolbar = document.querySelector('#toolbar-administration');\n    const header = document.querySelector('.combined-header-region');\n    const minimizedMenuSelected = header.classList.contains('is-minimized-sticky-menu');\n    // Exit if the admin toolbar is present.\n    if (toolbar) {\n      if (minimizedMenuSelected) {\n        header.classList.remove('is-minimized-sticky-menu', 'fixed-nav', 'fixed-nav--visible');\n      }\n      return;\n    }\n\n    // Exit if it's a news filter page\n    // advanced filter page\n    const pathname = window.location.pathname;\n    if (pathname === '/news/filter') {\n      return;\n    }\n\n    const root = document.documentElement;\n    const headerNav = document.querySelector('.header');\n    // Get the bottom Y coordinate of the Header.\n    let headerBottomY = '';\n    let headerFixedBottomY = '';\n    let headerTop = '';\n    let headerNavY = '';\n    let hasUniversalHeader = true;\n\n\n\n    // Calculate the Nav Height and set a CSS variable.\n    const setNavHeight = () => {\n      if (minimizedMenuSelected) {\n        headerTop = document.querySelector('.header-region');\n        headerNavY = headerTop.offsetHeight;\n        headerBottomY = headerNav.offsetHeight;\n        headerFixedBottomY = 60;\n        hasUniversalHeader = false;\n      } else {\n        // Exists.\n        headerTop = document.querySelector('.universal-header-region');\n        headerNavY = headerTop.offsetHeight;\n        headerBottomY = headerNav.offsetHeight + headerNavY;\n        headerFixedBottomY = 60 + headerNavY; // 60 is the height of the fixed-nav\n        // Get element height\n        let headerNavHeight = headerNav.offsetHeight;\n        // Set root variable of nav-height\n        root.style.setProperty('--nav-height', headerNavHeight + \"px\");\n      }\n\n      // Get element height\n      let headerNavHeight = headerNav.offsetHeight;\n      // Set root variable of nav-height\n      root.style.setProperty('--nav-height', headerNavHeight + \"px\");\n    }\n\n    // Set the initial nav height.\n    setNavHeight()\n\n    // Recalculate css variable on screen resize for the Nav height\n    const mql = matchMedia('(min-width: 850px)');\n    mql.addListener(setNavHeight);\n\n    // In Mobile, remove all the fixed classes when toggling the menu.\n    const mobileToggle = document.querySelector('.slicknav_btn');\n    mobileToggle.addEventListener('click', () => {\n      header.classList.remove('fixed-nav', 'fixed-nav--visible', 'fixed-nav--hidden', 'fixed-nav--pre-hidden');\n    });\n\n    // Toggle the .is-fixed class on scroll.\n    let lastScroll = 0;\n\n    // calculate weather user is scrolling up or down\n    // to reveal full navbar on up scroll\n    window.addEventListener(\"scroll\", () => {\n      const currentScroll = window.pageYOffset;\n\n      // make nav fixed only when user scrolled past navigation.\n      // In other words, put the navigation back to its normal spot.\n      if (currentScroll < headerNavY && hasUniversalHeader) {\n        header.classList.remove('fixed-nav', 'fixed-nav--visible', 'fixed-nav--hidden', 'fixed-nav--pre-hidden');\n        return;\n      }\n\n      // Ignore scrolling until 400px below so that it doesn't\n      // mess with the navigation in its normal position.\n      if (currentScroll > 400) {\n        // Ignore if the scroll position is the same.\n        // If scrolling down\n        if (currentScroll > lastScroll) {\n          if (!header.classList.contains('fixed-nav--pre-hidden')) {\n            header.classList.remove('fixed-nav--visible');\n              if (!header.classList.contains('fixed-nav')) {\n                header.classList.add('fixed-nav', 'fixed-nav--pre-hidden');\n              } else {\n                header.classList.add('fixed-nav--hidden');\n              }\n\n              header.classList.remove('fixed-nav--visible');\n          }\n        // If scrolling up\n        } else if (currentScroll < lastScroll) {\n          header.classList.remove('fixed-nav--hidden', 'fixed-nav--pre-hidden');\n          header.classList.add('fixed-nav', 'fixed-nav--visible');\n        }\n\n        // In between the normal position and the height where the sticky nav\n      // should start displaying.\n      } else if (currentScroll > headerBottomY) {\n        if (!header.classList.contains('fixed-nav')) {\n          header.classList.add('fixed-nav', 'fixed-nav--pre-hidden');\n        }\n\n        // Return to normal position when having never shown a sticky nav.\n        // If a pre-hidden class is applied (and assumed fixed-nav) then the\n        // navigation is vertically smaller than the normal navigation. So we need\n        // to wait until we have travelled to the height of the sticky nav so that\n        // we can then remove the fixed-nav and allow it to animate back to its\n        // normal height.\n      } else if (currentScroll < headerFixedBottomY) {\n        if (header.classList.contains('fixed-nav--pre-hidden')) {\n          header.classList.remove('fixed-nav', 'fixed-nav--pre-hidden');\n        }\n      }\n\n      lastScroll = currentScroll;\n    });\n\n  });\n}))(jQuery);\n"]}