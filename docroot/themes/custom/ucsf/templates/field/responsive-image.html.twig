{#
/**
 * @file
 * Theme override of a responsive image.
 *
 * Available variables:
 * - sources: The attributes of the <source> tags for this <picture> tag.
 * - img_element: The controlling image, with the fallback image in srcset.
 * - output_image_tag: Whether or not to output an <img> tag instead of a
 *   <picture> tag.
 *
 * @see template_preprocess()
 * @see template_preprocess_responsive_image()
 */
#}
{% if output_image_tag %}
  {{ img_element }}
{% else %}

    {% if sources %}
      {#
      Internet Explorer 9 doesn't recognise source elements that are wrapped in
      picture tags. See http://scottjehl.github.io/picturefill/#ie9
      #}
      <!--[if IE 9]><video style="display: none;"><![endif]-->
      {% for source_attributes in sources %}
        {# Removes lazyloading if a trigger attribute is present and the LazyLoad class is still on the element #}
        {% if (attributes.storage['data-no-lazyload']) and (source_attributes.hasClass('lazyload')) %}
          {# Removes LazyLoad class, saves data-srcset value to srcset attribute, removes data-srcset. #}
          {% set srcset = source_attributes.storage['data-srcset'] %}
          {% set source_attributes = source_attributes.removeClass('lazyload').removeAttribute('data-srcset').setAttribute('srcset', srcset) %}
        {% endif %}
        <source{{ source_attributes }}/>
      {% endfor %}
      <!--[if IE 9]></video><![endif]-->
    {% endif %}
    {# The controlling image, with the fallback image in srcset. #}
    {{ img_element }}

{% endif %}
